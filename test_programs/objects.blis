func main() {
    let one = Counter.new("uno");
    let two = Counter.new("dos");

    print(one);
    print(one.id, one.name);

    print(two);
    print(two.id, two.name);

    // Eventually, gradual typing will let you prevent this. But for now...
    one.two = two;
    two.one = one;

    print(one.two);
    print(one["two"]);
    print(two.one);
    print(two["one"]);
}

let id = 0;

type Counter with {
    func new(name) {
        id = id + 1;

        Counter {
            id = id,
            name = name,
            count = 0,
        }
    }

    func self.incr() {
        self.add(1);
    }

    func self.add(delta) {
        self.count = self.count + delta;
    }
}

main();

---
source: src/compile.rs
assertion_line: 1286
description: "func main() {\n    func outer(x) {\n        println(\"outer\");\n\n        func middle(name) {\n            println(\"middle\", name);\n\n            func inner() {\n                println(\"inner\", name);\n                println(x);\n                x = x + 1;\n                println(x);\n                println(\"-----\");\n            }\n\n            inner\n        }\n\n        middle\n    }\n\n    let middle = outer(0);\n    let inner1 = middle(\"first\");\n    inner1();\n    inner1();\n\n    let inner2 = middle(\"second\");\n    inner2();\n\n    middle = nil;\n\n    inner1();\n    inner1 = nil;\n\n    inner2();\n    inner2 = nil;\n}\n\nmain();\n"
input_file: test_programs/closures_stress.blis
---
Chunk(
  constants: [
    Func(Func(
      name: "main",
      arity: 0,
      upvalues: 0,
      chunk: Chunk(
        constants: [
          Func(Func(
            name: "outer",
            arity: 1,
            upvalues: 0,
            chunk: Chunk(
              constants: [
                String("outer"),
                Func(Func(
                  name: "middle",
                  arity: 1,
                  upvalues: 1,
                  chunk: Chunk(
                    constants: [
                      String("middle"),
                      Func(Func(
                        name: "inner",
                        arity: 0,
                        upvalues: 2,
                        chunk: Chunk(
                          constants: [
                            String("inner"),
                            Rational(((1, [
                              1,
                            ]), (1, [
                              1,
                            ]))),
                            String("-----"),
                          ],
                          globals: [
                            "println",
                          ],
                          code: [
                            39,
                            0,
                            4,
                            0,
                            34,
                            0,
                            16,
                            2,
                            1,
                            39,
                            0,
                            34,
                            1,
                            16,
                            1,
                            1,
                            34,
                            1,
                            4,
                            1,
                            56,
                            35,
                            1,
                            39,
                            0,
                            34,
                            1,
                            16,
                            1,
                            1,
                            39,
                            0,
                            4,
                            2,
                            16,
                            1,
                            1,
                            5,
                            3,
                            0,
                            0,
                          ],
                        ),
                      )),
                    ],
                    globals: [
                      "println",
                    ],
                    code: [
                      39,
                      0,
                      4,
                      0,
                      32,
                      1,
                      16,
                      2,
                      1,
                      17,
                      1,
                      1,
                      1,
                      0,
                      0,
                      32,
                      2,
                      3,
                      1,
                      0,
                    ],
                  ),
                )),
              ],
              globals: [
                "println",
              ],
              code: [
                39,
                0,
                4,
                0,
                16,
                1,
                1,
                17,
                1,
                1,
                1,
                32,
                2,
                3,
                1,
                0,
              ],
            ),
          )),
          Rational(((0, []), (1, [
            1,
          ]))),
          String("first"),
          String("second"),
        ],
        globals: [],
        code: [
          17,
          0,
          32,
          1,
          4,
          1,
          16,
          1,
          32,
          2,
          4,
          2,
          16,
          1,
          32,
          3,
          16,
          0,
          1,
          32,
          3,
          16,
          0,
          1,
          32,
          2,
          4,
          3,
          16,
          1,
          32,
          4,
          16,
          0,
          1,
          5,
          33,
          2,
          32,
          3,
          16,
          0,
          1,
          5,
          33,
          3,
          32,
          4,
          16,
          0,
          1,
          5,
          33,
          4,
          5,
          3,
          4,
          0,
        ],
      ),
    )),
  ],
  globals: [
    "main",
  ],
  code: [
    17,
    0,
    38,
    0,
    39,
    0,
    16,
    0,
    1,
    5,
    0,
  ],
)

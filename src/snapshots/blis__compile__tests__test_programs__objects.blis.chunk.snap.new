---
source: src/compile.rs
assertion_line: 1286
description: "func main() {\n    let one = Counter.new(\"uno\");\n    let two = Counter.new(\"dos\");\n\n    println(one);\n    println(one.id, one.name);\n\n    println(two);\n    println(two.id, two.name);\n\n    // Eventually, gradual typing will let you prevent this. But for now...\n    one.two = two;\n    two.one = one;\n\n    println(one.two);\n    println(one[\"two\"]);\n    println(two.one);\n    println(two[\"one\"]);\n}\n\nlet id = 0;\n\ntype Counter with {\n    func new(name) {\n        id = id + 1;\n\n        Counter {\n            id = id,\n            name = name,\n            count = 0,\n        }\n    }\n\n    func self.incr() {\n        self.add(1);\n    }\n\n    func self.add(delta) {\n        self.count = self.count + delta;\n    }\n}\n\nmain();\n"
input_file: test_programs/objects.blis
---
Chunk(
  constants: [
    Func(Func(
      name: "main",
      arity: 0,
      upvalues: 0,
      chunk: Chunk(
        constants: [
          String("new"),
          String("uno"),
          String("new"),
          String("dos"),
          String("id"),
          String("name"),
          String("id"),
          String("name"),
          String("two"),
          String("one"),
          String("two"),
          String("two"),
          String("one"),
          String("one"),
        ],
        globals: [
          "Counter",
          "println",
        ],
        code: [
          39,
          0,
          41,
          0,
          4,
          1,
          16,
          1,
          39,
          0,
          41,
          2,
          4,
          3,
          16,
          1,
          39,
          1,
          32,
          1,
          16,
          1,
          1,
          39,
          1,
          32,
          1,
          41,
          4,
          32,
          1,
          41,
          5,
          16,
          2,
          1,
          39,
          1,
          32,
          2,
          16,
          1,
          1,
          39,
          1,
          32,
          2,
          41,
          6,
          32,
          2,
          41,
          7,
          16,
          2,
          1,
          32,
          1,
          32,
          2,
          42,
          8,
          1,
          32,
          2,
          32,
          1,
          42,
          9,
          1,
          39,
          1,
          32,
          1,
          41,
          10,
          16,
          1,
          1,
          39,
          1,
          32,
          1,
          4,
          11,
          45,
          16,
          1,
          1,
          39,
          1,
          32,
          2,
          41,
          12,
          16,
          1,
          1,
          39,
          1,
          32,
          2,
          4,
          13,
          45,
          16,
          1,
          1,
          5,
          3,
          2,
          0,
        ],
      ),
    )),
    Rational(((0, []), (1, [
      1,
    ]))),
    String("Counter"),
    Func(Func(
      name: "new",
      arity: 1,
      upvalues: 0,
      chunk: Chunk(
        constants: [
          Rational(((1, [
            1,
          ]), (1, [
            1,
          ]))),
          String("id"),
          String("name"),
          String("count"),
          Rational(((0, []), (1, [
            1,
          ]))),
        ],
        globals: [
          "id",
          "Counter",
        ],
        code: [
          39,
          0,
          4,
          0,
          56,
          40,
          0,
          39,
          1,
          9,
          39,
          0,
          42,
          1,
          32,
          0,
          42,
          2,
          4,
          4,
          42,
          3,
          3,
          0,
          0,
        ],
      ),
    )),
    String("new"),
    Func(Func(
      name: "incr",
      arity: 0,
      upvalues: 0,
      chunk: Chunk(
        constants: [
          String("add"),
          Rational(((1, [
            1,
          ]), (1, [
            1,
          ]))),
        ],
        globals: [],
        code: [
          32,
          0,
          41,
          0,
          4,
          1,
          16,
          1,
          1,
          5,
          3,
          0,
          0,
        ],
      ),
    )),
    String("incr"),
    Func(Func(
      name: "add",
      arity: 1,
      upvalues: 0,
      chunk: Chunk(
        constants: [
          String("count"),
          String("count"),
        ],
        globals: [],
        code: [
          32,
          0,
          32,
          0,
          41,
          1,
          32,
          1,
          56,
          42,
          0,
          1,
          5,
          3,
          0,
          0,
        ],
      ),
    )),
    String("add"),
  ],
  globals: [
    "main",
    "id",
    "Counter",
  ],
  code: [
    17,
    0,
    38,
    0,
    4,
    1,
    38,
    1,
    10,
    2,
    17,
    3,
    44,
    4,
    17,
    5,
    44,
    6,
    17,
    7,
    44,
    8,
    38,
    2,
    39,
    0,
    16,
    0,
    1,
    5,
    0,
  ],
)
